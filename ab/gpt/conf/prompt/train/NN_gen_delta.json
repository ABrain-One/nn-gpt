{
  "improvement_classification_delta": {
    "comment": [
      "Delta-based generation: LLM generates code deltas instead of full code"
    ],
    "use_delta": true,
    "task": "img-classification",
    "addon_task": null,
    "num_joint_nns": 2,
    "improve": true,
    "input_list": [
      {"para": "nn_code", "value": "nn_code"},
      {"para": "accuracy", "value": "accuracy"},
      {"para": "epoch", "value": "epoch"},
      {"para": "dataset", "value": "dataset"},
      {"para": "task", "value": "task"},
      {"para": "metric", "value": "metric"},
      {"para": "transform_code", "value": "transform_code"},
      {"para": "prm", "value": "prm"},
      {"para": "addon_accuracy", "value": "accuracy_2"},
      {"para": "addon_epoch", "value": "epoch_2"},
      {"para": "addon_nn_code", "value": "nn_code_2"},
      {"para": "addon_transform_code", "value": "transform_code_2"},
      {"para": "addon_prm", "value": "prm_2"}
    ],
    "no_repeat": ["nn"],
    "keep_same": ["epoch", "metric", "dataset", "task"],
    "nn_prefixes": [],
    "prompt": [
      "OUTPUT ONLY THE 3 XML SECTIONS BELOW. NO explanations. NO reasoning. NO markdown.",
      "",
      "=== REQUIRED OUTPUT FORMAT ===",
      "",
      "<hp>",
      "{{\"batch\": 64, \"transform\": \"norm_32\", \"lr\": 0.01, \"momentum\": 0.9}}",
      "</hp>",
      "",
      "<tr>",
      "import torchvision.transforms as transforms",
      "",
      "def transform(norm):",
      "    return transforms.Compose([",
      "        transforms.Resize(32),",
      "        transforms.ToTensor(),",
      "        transforms.Normalize(*norm)",
      "    ])",
      "</tr>",
      "",
      "<delta>",
      "--- baseline.py",
      "+++ improved.py",
      "@@ -23,6 +23,7 @@",
      "     def __init__(self, in_channels, out_channels, stride):",
      "         super().__init__()",
      "         self.layers = nn.Sequential(",
      "+            nn.Dropout(0.2),",
      "             nn.Conv2d(in_channels, out_channels, kernel_size=3, stride=stride, padding=1),",
      "             nn.BatchNorm2d(out_channels),",
      "</delta>",
      "",
      "=== TASK ===",
      "Improve baseline model to maximize '{metric}' at epoch {epoch} on '{dataset}' for '{task}'.",
      "Baseline accuracy: {accuracy}",
      "",
      "=== DELTA RULES ===",
      "- Start with '--- baseline.py' and '+++ improved.py'",
      "- Use '@@ -line,count +line,count @@' hunk headers",
      "- Context lines start with SPACE, deletions with '-', additions with '+'",
      "- Each hunk must have correct line numbers matching the baseline",
      "",
      "=== FORBIDDEN ===",
      "- NO text before <hp>",
      "- NO explanations or reasoning",
      "- NO markdown code fences",
      "- NO <nn> tags in output (delta replaces this)",
      "",
      "=== BASELINE CODE ===",
      "<hp>{prm}</hp>",
      "<tr>{transform_code}</tr>",
      "<nn>{nn_code}</nn>"
    ],
    "output": [
      "<hp>{addon_prm}</hp>",
      "<tr>{addon_transform_code}</tr>",
      "<delta>{computed_delta}</delta>"
    ]
  }
}
